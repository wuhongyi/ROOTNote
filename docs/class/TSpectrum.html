

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TSpectrum* &mdash; ROOT Note 1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="TSpectrum2" href="TSpectrum2.html" />
    <link rel="prev" title="TSelectorScalar" href="TSelectorScalar.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ROOT Note
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">简介</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">简介</a></li>
</ul>
<p class="caption"><span class="caption-text">base类的使用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">类的使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="TObject.html">TObject*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTask.html">TTask+</a></li>
<li class="toctree-l1"><a class="reference internal" href="Buttons.html">Buttons*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TNamed.html">TNamed+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TStyle.html">TStyle+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSystem.html">TSystem*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TROOT.html">TROOT*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFolder.html">TFolder</a></li>
<li class="toctree-l1"><a class="reference internal" href="TEnv.html">TEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMacro.html">TMacro</a></li>
<li class="toctree-l1"><a class="reference internal" href="TApplication.html">TApplication</a></li>
<li class="toctree-l1"><a class="reference internal" href="TProcessID.html">TProcessID</a></li>
<li class="toctree-l1"><a class="reference internal" href="TProcessUUID.html">TProcessUUID</a></li>
<li class="toctree-l1"><a class="reference internal" href="TString.html">TString+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TColor.html">TColor*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBase64.html">TBase64</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMD5.html">TMD5</a></li>
</ul>
<p class="caption"><span class="caption-text">IO类的使用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">类的使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="TKey.html">TKey*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TDirectory.html">TDirectory*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TDirectoryFile.html">TDirectoryFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSystemFile.html">TSystemFile+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSystemDirectory.html">TSystemDirectory+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFile.html">TFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFileCacheWrite.html">TFileCacheWrite*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFileCacheRead.html">TFileCacheRead*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFileMerger.html">TFileMerger*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMemFile.html">TMemFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TKeyMapFile.html">TKeyMapFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMapFile.html">TMapFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TArchiveFile.html">TArchiveFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TZIPFile.html">TZIPFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFilePrefetch.html">TFilePrefetch*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFPBlock.html">TFPBlock*</a></li>
<li class="toctree-l1"><a class="reference internal" href="THDFSFile.html">THDFSFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBuffer.html">TBuffer+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBufferFile.html">TBufferFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBufferJSON.html">TBufferJSON*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TKeySQL.html">TKeySQL*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSQLObjectData.html">TSQLObjectData*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSQLStructure.html">TSQLStructure-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSQLClassInfo.html">TSQLClassInfo*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBufferSQL2.html">TBufferSQL2</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSQLFile.html">TSQLFile*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TXMLEngine.html">TXMLEngine-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBufferXML.html">TBufferXML-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TXMLSetup.html">TXMLSetup-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TKeyXML.html">TKeyXML-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TXMLPlayer.html">TXMLPlayer-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TXMLFile.html">TXMLFile-</a></li>
</ul>
<p class="caption"><span class="caption-text">常用类的使用</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">类的使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTree.html">TTree*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TCut.html">TCut*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTreePlayer.html">TTreePlayer*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TChain.html">TChain*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TEventList.html">TEventList*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBranch.html">TBranch*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TNtuple.html">TNtuple*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TNtupleD.html">TNtupleD*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TCollection.html">TCollection*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSeqCollection.html">TSeqCollection*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TList.html">TList*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TVirtualFitter.html">TVirtualFitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBackCompFitter.html">TBackCompFitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="FitResult.html">FitResult</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFitter.html">TFitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFitResult.html">TFitResult</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFitResultPtr.html">TFitResultPtr</a></li>
<li class="toctree-l1"><a class="reference internal" href="TFractionFitter.html">TFractionFitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TLinearFitter.html">TLinearFitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TAttAxis.html">TAttAxis*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TAxis.html">TAxis*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGaxis.html">TGaxis*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGaxis.html#example">example</a></li>
<li class="toctree-l1"><a class="reference internal" href="TText.html">TText*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPaveStats.html">TPaveStats*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPolyMarker.html">TPolyMarker</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPaveText.html">TPaveText*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPolyMarker3D.html">TPolyMarker3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="TLatex.html">TLatex*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TLegend.html">TLegend*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TLegendEntry.html">TLegendEntry*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TLine.html">TLine*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TVirtualPad.html">TVirtualPad*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPad.html">TPad*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TCanvas.html">TCanvas*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TF1.html">TF1*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TF2.html">TF2</a></li>
<li class="toctree-l1"><a class="reference internal" href="TF3.html">TF3</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGraph.html">TGraph*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TCutG.html">TCutG*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMultiGraph.html">TMultiGraph+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGraph2D.html">TGraph2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGraph2DErrors.html">TGraph2DErrors</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGraphErrors.html">TGraphErrors</a></li>
<li class="toctree-l1"><a class="reference internal" href="TGraphPolar.html">TGraphPolar</a></li>
<li class="toctree-l1"><a class="reference internal" href="TH1.html">TH1*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TH2.html">TH2+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TH2Poly.html">TH2Poly*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TH3.html">TH3</a></li>
<li class="toctree-l1"><a class="reference internal" href="TProfile.html">TProfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="TProfile2D.html">TProfile2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="TProfile3D.html">TProfile3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMath.html">TMath*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMathBase.html">TMathBase*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMatrixT.html">TMatrixT</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMatrixTBase.html">TMatrixTBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMatrixTSparse.html">TMatrixTSparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMatrixTSym.html">TMatrixTSym</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpline.html">TSpline+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMinuit.html">TMinuit*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMinuitMinimizer.html">TMinuitMinimizer*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRandom.html">TRandom*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRandom1.html">TRandom1*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRandom2.html">TRandom2*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRandom3.html">TRandom3*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelector.html">TSelector-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelectorCint.html">TSelectorCint</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelectorDraw.html">TSelectorDraw</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelectorEntries.html">TSelectorEntries</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelectorList.html">TSelectorList-</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSelectorScalar.html">TSelectorScalar</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TSpectrum*</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class">class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code">code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrum2.html">TSpectrum2</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrum2Fit.html">TSpectrum2Fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrum2Painter.html">TSpectrum2Painter</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrum2Transform.html">TSpectrum2Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrum3.html">TSpectrum3</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrumFit.html">TSpectrumFit</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSpectrumTransform.html">TSpectrumTransform</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTime.html">TTime*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTimer.html">TTimer*</a></li>
<li class="toctree-l1"><a class="reference internal" href="TTimeStamp.html">TTimeStamp</a></li>
<li class="toctree-l1"><a class="reference internal" href="TStopwatch.html">TStopwatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="TBenchmark.html">TBenchmark+</a></li>
<li class="toctree-l1"><a class="reference internal" href="TThread.html">TThread</a></li>
<li class="toctree-l1"><a class="reference internal" href="TThreadFactory.html">TThreadFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="TThreadImp.html">TThreadImp</a></li>
<li class="toctree-l1"><a class="reference internal" href="TServerSocket.html">TServerSocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="TSocket.html">TSocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPServerSocket.html">TPServerSocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPSocket.html">TPSocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="TEllipse.html">TEllipse</a></li>
<li class="toctree-l1"><a class="reference internal" href="TNeuron.html">TNeuron</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMLPAnalyzer.html">TMLPAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMonitor.html">TMonitor</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMultiLayerPerceptron.html">TMultiLayerPerceptron</a></li>
</ul>
<p class="caption"><span class="caption-text">图形界面的使用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gui/README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/GuiTypes.html">GuiTypes*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGButton.html">TGButton*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGButtonGroup.html">TGButtonGroup*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGCanvas.html">TGCanvas*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGClient.html">TGClient*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGColorDialog.html">TGColorDialog*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGColorSelect.html">TGColorSelect*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGComboBox.html">TGComboBox*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGCommandPlugin.html">TGCommandPlugin*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGDimension.html">TGDimension*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGDNDManager.html">TGDNDManager*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGDockableFrame.html">TGDockableFrame*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGDoubleSlider.html">TGDoubleSlider*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGEventHandler.html">TGEventHandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFileBrowser.html">TGFileBrowser</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFileDialog.html">TGFileDialog</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFont.html">TGFont*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFontDialog.html">TGFontDialog*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFrame.html">TGFrame*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFSComboBox.html">TGFSComboBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGFSContainer.html">TGFSContainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGGC.html">TGGC*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGIcon.html">TGIcon*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGIdleHandler.html">TGIdleHandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGImageMap.html">TGImageMap*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGInputDialog.html">TGInputDialog</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGLabel.html">TGLabel*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGLayout.html">TGLayout+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGListBox.html">TGListBox+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGListTree.html">TGListTree*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGListView.html">TGListView+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMdiDecorFrame.html">TGMdiDecorFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMdiFrame.html">TGMdiFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMdiMainFrame.html">TGMdiMainFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMdiMenu.html">TGMdiMenu</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMenu.html">TGMenu+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMimeTypes.html">TGMimeTypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGMsgBox.html">TGMsgBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGNumberEntry.html">TGNumberEntry+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGObject.html">TGObject*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGPack.html">TGPack</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGPasswdDialog.html">TGPasswdDialog</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGPicture.html">TGPicture+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGProgressBar.html">TGProgressBar*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGRedirectOutputGuard.html">TGRedirectOutputGuard</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGResourcePool.html">TGResourcePool</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGScrollBar.html">TGScrollBar+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGShapedFrame.html">TGShapedFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGShutter.html">TGShutter</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSimpleTable.html">TGSimpleTable+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSimpleTableInterface.html">TGSimpleTableInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSlider.html">TGSlider+</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSpeedo.html">TGSpeedo*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSplitFrame.html">TGSplitFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGSplitter.html">TGSplitter*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGStatusBar.html">TGStatusBar*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGString.html">TGString</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTab.html">TGTab*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTable.html">TGTable*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTableCell.html">TGTableCell-</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTableContainer.html">TGTableContainer-</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTableHeader.html">TGTableHeader-</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTableLayout.html">TGTableLayout-</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGText.html">TGText</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextBuffer.html">TGTextBuffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextEdit.html">TGTextEdit</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextEditDialogs.html">TGTextEditDialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextEditor.html">TGTextEditor</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextEntry.html">TGTextEntry*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextView.html">TGTextView</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTextViewStream.html">TGTextViewStream*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGToolBar.html">TGToolBar</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGToolTip.html">TGToolTip</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGTripleSlider.html">TGTripleSlider*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGuiBuilder.html">TGuiBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGView.html">TGView*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGWidget.html">TGWidget*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGWindow.html">TGWindow*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TGXYLayout.html">TGXYLayout</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TQObject.html">TQObject*</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui/TRootEmbeddedCanvas.html">TRootEmbeddedCanvas*</a></li>
</ul>
<p class="caption"><span class="caption-text">GRAF3D</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="graf3d/README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TAxis3D.html">TAxis3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TBRIK.html">TBRIK*</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TCONE.html">TCONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TCONS.html">TCONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TCTUB.html">TCTUB</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TELTU.html">TELTU</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TGeometry.html">TGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TGTRA.html">TGTRA</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/THelix.html">THelix</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/THYPE.html">THYPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TMarker3DBox.html">TMarker3DBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TMaterial.html">TMaterial</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TMixture.html">TMixture</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TNodeDiv.html">TNodeDiv</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TNode.html">TNode*</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPARA.html">TPARA</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPCON.html">TPCON</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPGON.html">TPGON</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPoints3DABC.html">TPoints3DABC</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPointSet3D.html">TPointSet3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPolyLine3D.html">TPolyLine3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TPolyMarker3D.html">TPolyMarker3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TRotMatrix.html">TRotMatrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TShape.html">TShape*</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TSPHE.html">TSPHE*</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TTRAP.html">TTRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TTRD1.html">TTRD1</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TTRD2.html">TTRD2</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TTUBE.html">TTUBE</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TTUBS.html">TTUBS</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TView3D.html">TView3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/TXTRU.html">TXTRU</a></li>
<li class="toctree-l1"><a class="reference internal" href="graf3d/X3DBuffer.html">X3DBuffer</a></li>
</ul>
<p class="caption"><span class="caption-text">physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="math/README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TFeldmanCousins.html">TFeldmanCousins*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TGenPhaseSpace.html">TGenPhaseSpace*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TLorentzRotation.html">TLorentzRotation*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TLorentzVector.html">TLorentzVector*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TQuaternion.html">TQuaternion*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TRobustEstimator.html">TRobustEstimator*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TRolke.html">TRolke*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TRotation.html">TRotation*</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TVectorT.html">TVectorT</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TVector2.html">TVector2</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/TVector3.html">TVector3*</a></li>
</ul>
<p class="caption"><span class="caption-text">net</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="net/README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/TCivetweb.html">TCivetweb</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/TFastCgi.html">TFastCgi</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/THttpCallArg.html">THttpCallArg</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/THttpEngine.html">THttpEngine</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/THttpServer.html">THttpServer</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/THttpWSEngine.html">THttpWSEngine</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/THttpWSHandler.html">THttpWSHandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/TRootSniffer.html">TRootSniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="net/TRootSnifferStore.html">TRootSnifferStore</a></li>
</ul>
<p class="caption"><span class="caption-text">数据结构</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../structure/README.html">数据结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/datarecord.html">datarecord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/dobject.html">dataobject</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/freesegments.html">FreeSegments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/gap.html">gap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/header.html">header</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/keyslist.html">KeysList</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/StreamerInfo.html">StreamerInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TClonesArray.html">TClonesArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TDirectory.html">TDirectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TFile.html">TFile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TObject.html">TObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TProcessID.html">TProcessID</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TRefArray.html">TRefArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TRef.html">TRef</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure/TTree.html">TTree</a></li>
</ul>
<p class="caption"><span class="caption-text">预定义</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../define/README.html">预定义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../define/RVersion.html">RVersion</a></li>
</ul>
<p class="caption"><span class="caption-text">文件版本</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../version/version.html">文件更新版本</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ROOT Note</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>TSpectrum*</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/class/TSpectrum.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- TSpectrum.md --- 
;; 
;; Description: 
;; Author: Hongyi Wu(吴鸿毅)
;; Email: wuhongyi@qq.com 
;; Created: 六 8月 13 12:47:30 2016 (+0800)
;; Last-Updated: 三 9月 16 12:58:59 2020 (+0800)
;;           By: Hongyi Wu(吴鸿毅)
;;     Update #: 8
;; URL: http://wuhongyi.cn --><div class="section" id="tspectrum">
<h1>TSpectrum*<a class="headerlink" href="#tspectrum" title="永久链接至标题">¶</a></h1>
<div class="section" id="class">
<h2>class<a class="headerlink" href="#class" title="永久链接至标题">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TSpectrum</span><span class="p">();</span>
<span class="n">TSpectrum</span><span class="p">(</span><span class="n">Int_t</span> <span class="n">maxpositions</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="k">virtual</span> <span class="o">~</span><span class="n">TSpectrum</span><span class="p">();</span>
<span class="k">virtual</span> <span class="n">TH1</span>        <span class="o">*</span><span class="nf">Background</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">niter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="n">TH1</span>                <span class="o">*</span><span class="nf">GetHistogram</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">fHistogram</span><span class="p">;}</span><span class="c1">//暂未实施</span>
<span class="n">Int_t</span>               <span class="nf">GetNPeaks</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">fNPeaks</span><span class="p">;}</span>
<span class="n">Double_t</span>            <span class="o">*</span><span class="nf">GetPositionX</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">fPositionX</span><span class="p">;}</span>
<span class="n">Double_t</span>            <span class="o">*</span><span class="nf">GetPositionY</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">fPositionY</span><span class="p">;}</span>
<span class="k">virtual</span> <span class="kt">void</span>        <span class="nf">Print</span><span class="p">(</span><span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<span class="k">virtual</span> <span class="n">Int_t</span>       <span class="nf">Search</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span><span class="c1">//option 可选</span>
<span class="k">static</span> <span class="kt">void</span>         <span class="nf">SetAverageWindow</span><span class="p">(</span><span class="n">Int_t</span> <span class="n">w</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>   <span class="c1">//set average window</span>
<span class="k">static</span> <span class="kt">void</span>         <span class="nf">SetDeconIterations</span><span class="p">(</span><span class="n">Int_t</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span> <span class="c1">//set max number of decon iterations</span>
<span class="kt">void</span>                <span class="nf">SetResolution</span><span class="p">(</span><span class="n">Double_t</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">//new functions January 2006</span>
<span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">Background</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberIterations</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">direction</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">filterOrder</span><span class="p">,</span><span class="kt">bool</span> <span class="n">smoothing</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">smoothWindow</span><span class="p">,</span><span class="kt">bool</span> <span class="n">compton</span><span class="p">);</span><span class="c1">//实际计算background函数</span>
<span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">SmoothMarkov</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">averWindow</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">Deconvolution</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="k">const</span> <span class="n">Double_t</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">numberIterations</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberRepetitions</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">boost</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">DeconvolutionRL</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="k">const</span> <span class="n">Double_t</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">numberIterations</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberRepetitions</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">boost</span> <span class="p">);</span>
<span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">Unfolding</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="k">const</span> <span class="n">Double_t</span> <span class="o">**</span><span class="n">respMatrix</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">ssizex</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssizey</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberIterations</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberRepetitions</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">boost</span><span class="p">);</span>
<span class="n">Int_t</span>               <span class="nf">SearchHighRes</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">destVector</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span><span class="n">Double_t</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">threshold</span><span class="p">,</span><span class="kt">bool</span> <span class="n">backgroundRemove</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">deconIterations</span><span class="p">,</span><span class="kt">bool</span> <span class="n">markov</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">averWindow</span><span class="p">);</span><span class="c1">//实际寻峰函数</span>
<span class="n">Int_t</span>               <span class="nf">Search1HighRes</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">destVector</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span><span class="n">Double_t</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">threshold</span><span class="p">,</span><span class="kt">bool</span> <span class="n">backgroundRemove</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">deconIterations</span><span class="p">,</span><span class="kt">bool</span> <span class="n">markov</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">averWindow</span><span class="p">);</span>

<span class="k">static</span> <span class="n">Int_t</span>        <span class="nf">StaticSearch</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;goff&quot;</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span>
<span class="k">static</span> <span class="n">TH1</span>         <span class="o">*</span><span class="nf">StaticBackground</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">niter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">virtual</span> <span class="n">TH1</span>        <span class="o">*</span><span class="nf">Background</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">niter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">);</span>

<span class="k">enum</span> <span class="p">{</span>
  <span class="n">kBackOrder2</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">kBackOrder4</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">kBackOrder6</span> <span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">kBackOrder8</span> <span class="o">=</span><span class="mi">3</span><span class="p">,</span>
  <span class="n">kBackIncreasingWindow</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">kBackDecreasingWindow</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">kBackSmoothing3</span> <span class="o">=</span><span class="mi">3</span><span class="p">,</span>
  <span class="n">kBackSmoothing5</span> <span class="o">=</span><span class="mi">5</span><span class="p">,</span>
  <span class="n">kBackSmoothing7</span> <span class="o">=</span><span class="mi">7</span><span class="p">,</span>
  <span class="n">kBackSmoothing9</span> <span class="o">=</span><span class="mi">9</span><span class="p">,</span>
  <span class="n">kBackSmoothing11</span> <span class="o">=</span><span class="mi">11</span><span class="p">,</span>
  <span class="n">kBackSmoothing13</span> <span class="o">=</span><span class="mi">13</span><span class="p">,</span>
  <span class="n">kBackSmoothing15</span> <span class="o">=</span><span class="mi">15</span>
<span class="p">};</span>

<span class="c1">// One-dimensional background estimation function.</span>
<span class="c1">// This function calculates the background spectrum in the input histogram h.The background is returned as a histogram.</span>

<span class="c1">// Function parameters:</span>

<span class="c1">// h: input 1-d histogram</span>
<span class="c1">// numberIterations, (default value = 20).Increasing numberIterations make the result smoother and lower.</span>
<span class="c1">// option: may contain one of the following options:</span>

<span class="c1">// to set the direction parameter</span>
<span class="c1">// &quot;BackIncreasingWindow&quot;. By default the direction is BackDecreasingWindow</span>
<span class="c1">// filterOrder-order of clipping filter,  (default &quot;BackOrder2&quot;)</span>
<span class="c1">// -possible values= &quot;BackOrder4&quot;</span>
<span class="c1">// &quot;BackOrder6&quot;</span>
<span class="c1">// &quot;BackOrder8&quot;</span>
<span class="c1">// &quot;nosmoothing&quot;- if selected, the background is not smoothed</span>
<span class="c1">// By default the background is smoothed.</span>
<span class="c1">// smoothWindow-width of smoothing window, (default is &quot;BackSmoothing3&quot;)</span>
<span class="c1">// -possible values= &quot;BackSmoothing5&quot;</span>
<span class="c1">// &quot;BackSmoothing7&quot;</span>
<span class="c1">// &quot;BackSmoothing9&quot;</span>
<span class="c1">// &quot;BackSmoothing11&quot;</span>
<span class="c1">// &quot;BackSmoothing13&quot;</span>
<span class="c1">// &quot;BackSmoothing15&quot;</span>
<span class="c1">// &quot;Compton&quot; if selected the estimation of Compton edge</span>
<span class="c1">// will be included.</span>
<span class="c1">// &quot;same&quot; : if this option is specified, the resulting background</span>
<span class="c1">// histogram is superimposed on the picture in the current pad.</span>

<span class="c1">// NOTE that the background is only evaluated in the current range of h.</span>
<span class="c1">// ie, if h has a bin range (set via h-&gt;GetXaxis()-&gt;SetRange(binmin,binmax),</span>
<span class="c1">// the returned histogram will be created with the same number of bins</span>
<span class="c1">// as the input histogram h, but only bins from binmin to binmax will be filled</span>
<span class="c1">// with the estimated background.</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">virtual</span> <span class="n">Int_t</span>       <span class="nf">Search</span><span class="p">(</span><span class="k">const</span> <span class="n">TH1</span> <span class="o">*</span><span class="n">hist</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Option_t</span> <span class="o">*</span><span class="n">option</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Double_t</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span>

<span class="c1">// One-dimensional peak search function</span>
<span class="c1">// This function searches for peaks in source spectrum in hin.The number of found peaks and their positions are written into the members fNpeaks and fPositionX. The search is performed in the current histogram range.</span>

<span class="c1">// Function parameters:</span>
<span class="c1">// hin:       pointer to the histogram of source spectrum</span>
<span class="c1">// sigma:   sigma of searched peaks, for details we refer to manual</span>
<span class="c1">// threshold: (default=0.05)  peaks with amplitude less than</span>
<span class="c1">// threshold*highest_peak are discarded.  0&lt;threshold&lt;1</span>

<span class="c1">// By default, the background is removed before deconvolution.</span>
<span class="c1">// Specify the option &quot;nobackground&quot; to not remove the background.</span>

<span class="c1">// By default the &quot;Markov&quot; chain algorithm is used.</span>
<span class="c1">// Specify the option &quot;noMarkov&quot; to disable this algorithm</span>
<span class="c1">// Note that by default the source spectrum is replaced by a new spectrum</span>

<span class="c1">// By default a polymarker object is created and added to the list of</span>
<span class="c1">// functions of the histogram. The histogram is drawn with the specified</span>
<span class="c1">// option and the polymarker object drawn on top of the histogram.</span>
<span class="c1">// The polymarker coordinates correspond to the npeaks peaks found in</span>
<span class="c1">// the histogram.</span>

<span class="c1">// A pointer to the polymarker object can be retrieved later via:</span>

<span class="c1">// TList *functions = hin-&gt;GetListOfFunctions();</span>
<span class="c1">// TPolyMarker *pm = (TPolyMarker*)functions-&gt;FindObject(&quot;TPolyMarker&quot;);</span>

<span class="c1">// Specify the option &quot;goff&quot; to disable the storage and drawing of the</span>
<span class="c1">// polymarker.</span>
<span class="c1">// To disable the final drawing of the histogram with the search results (in case</span>
<span class="c1">// you want to draw it yourself) specify &quot;nodraw&quot; in the options parameter.</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="nf">Background</span><span class="p">(</span><span class="n">Double_t</span> <span class="o">*</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">ssize</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">numberIterations</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">direction</span><span class="p">,</span> <span class="n">Int_t</span> <span class="n">filterOrder</span><span class="p">,</span><span class="kt">bool</span> <span class="n">smoothing</span><span class="p">,</span><span class="n">Int_t</span> <span class="n">smoothWindow</span><span class="p">,</span><span class="kt">bool</span> <span class="n">compton</span><span class="p">);</span>
<span class="c1">// This function calculates background spectrum from source spectrum.</span>
<span class="c1">// The result is placed in the vector pointed by spe1945ctrum pointer.</span>
<span class="c1">// The goal is to separate the useful information (peaks) from useless</span>
<span class="c1">// information (background).</span>

<span class="c1">// method is based on Sensitive Nonlinear Iterative Peak (SNIP) clipping algorithm.</span>
<span class="c1">// new value in the channel &quot;i&quot; is calculated</span>

<span class="c1">// where p = 1, 2, ..., numberIterations. In fact it represents second order</span>
<span class="c1">// difference filter (-1,2,-1).</span>

<span class="c1">// One can also change the</span>
<span class="c1">// direction of the change of the clipping window, the order of the clipping</span>
<span class="c1">// filter, to include smoothing, to set width of smoothing window and to include</span>
<span class="c1">// the estimation of Compton edges. On successful completion it returns 0. On</span>
<span class="c1">// error it returns pointer to the string describing error.</span>

<span class="c1">// Parameters:</span>
<span class="c1">// spectrum: pointer to the vector of source spectrum</span>
<span class="c1">// ssize: length of the spectrum vector</span>
<span class="c1">// numberIterations: maximal width of clipping window,</span>
<span class="c1">// direction:  direction of change of clipping window.Possible values: kBackIncreasingWindow, kBackDecreasingWindow</span>
<span class="c1">// filterOrder: order of clipping filter.Possible values: kBackOrder2, kBackOrder4, kBackOrder6, kBackOrder8</span>
<span class="c1">// smoothing: logical variable whether the smoothing operation in the estimation of background will be included.Possible values: kFALSE, kTRUE</span>
<span class="c1">// smoothWindow: width of smoothing window.Possible values: kBackSmoothing3, kBackSmoothing5, kBackSmoothing7,kBackSmoothing9, kBackSmoothing11, kBackSmoothing13, kBackSmoothing15.</span>
<span class="c1">// compton: logical variable whether the estimation of Compton edge will be included. Possible values: kFALSE, kTRUE.</span>
</pre></div>
</div>
</div>
<div class="section" id="code">
<h2>code<a class="headerlink" href="#code" title="永久链接至标题">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Int_t</span> <span class="n">npeaks</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">npeaks</span><span class="p">);</span>
<span class="n">Int_t</span> <span class="n">nfound</span> <span class="o">=</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">Search</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="mf">0.1</span><span class="p">);</span>
<span class="kt">double</span> <span class="o">*</span><span class="n">number</span><span class="o">=</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">GetPositionX</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nfound</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">number</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
  <span class="p">}</span>
<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;!!!:&quot;</span><span class="o">&lt;&lt;</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">GetNPeaks</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="永久链接至标题">¶</a></h2>
<p><strong>以下例子年代久远，仅供参考，不能运行：</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_incr</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="n">nbins</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">back</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;back&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">back</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back1;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">Background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;Background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Background</span><span class="p">)</span> <span class="n">Background</span> <span class="o">=</span>
     <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;Background&quot;</span><span class="p">,</span>
                 <span class="s">&quot;Estimation of background with increasing window&quot;</span><span class="p">,</span>
                 <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">back</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">back</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">kBackIncreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
                 <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_decr</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="n">nbins</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">back</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;back&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">back</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back1;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">Background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;Background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Background</span><span class="p">)</span> <span class="n">Background</span> <span class="o">=</span>
     <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;Background&quot;</span><span class="p">,</span><span class="s">&quot;Estimation of background with decreasing window&quot;</span><span class="p">,</span>
                 <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">back</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">back</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
                 <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_width</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="n">nbins</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d1&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d2&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d3&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back1;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">background</span><span class="p">)</span> <span class="n">background</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span>
   <span class="s">&quot;Influence of clipping window width on the estimated background&quot;</span><span class="p">,</span>
   <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kBlue</span><span class="p">);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kGreen</span><span class="p">);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_width2</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d1&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d2&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d3&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d4&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back2;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">background</span><span class="p">)</span> <span class="n">background</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span>
   <span class="s">&quot;Influence of clipping window width on the estimated background&quot;</span><span class="p">,</span>
   <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">SetAxisRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">SetMaximum</span><span class="p">(</span><span class="mi">20000</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kBlue</span><span class="p">);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kGreen</span><span class="p">);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d4</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d4</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kMagenta</span><span class="p">);</span>
   <span class="n">d4</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_order</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d1&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d2&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d3&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d4&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back2;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">background</span><span class="p">)</span> <span class="n">background</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span>
   <span class="s">&quot;Influence of clipping filter difference order on the estimated background&quot;</span><span class="p">,</span>
   <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">SetAxisRange</span><span class="p">(</span><span class="mi">1220</span><span class="p">,</span><span class="mi">1460</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">SetMaximum</span><span class="p">(</span><span class="mi">11000</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder4</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kBlue</span><span class="p">);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder6</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kGreen</span><span class="p">);</span>
   <span class="n">d3</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder8</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d4</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d4</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kMagenta</span><span class="p">);</span>
   <span class="n">d4</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_smooth</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="n">nbins</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d1&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d2&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back4;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">background</span><span class="p">)</span> <span class="n">background</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span>
   <span class="s">&quot;Estimation of background with noise&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">SetAxisRange</span><span class="p">(</span><span class="mi">3460</span><span class="p">,</span><span class="mi">3830</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder2</span><span class="p">,</span><span class="n">kTRUE</span><span class="p">,</span>
   <span class="n">kBackSmoothing3</span><span class="p">,</span><span class="n">kFALSE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kBlue</span><span class="p">);</span>
   <span class="n">d2</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;TSpectrum&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">Background_compton</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">Int_t</span> <span class="n">i</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">nbins</span> <span class="o">=</span> <span class="mi">512</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmin</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="n">xmax</span>  <span class="o">=</span> <span class="n">nbins</span><span class="p">;</span>
   <span class="n">Double_t</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double_t</span><span class="p">[</span><span class="n">nbins</span><span class="p">];</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TH1F</span> <span class="o">*</span><span class="n">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TH1F</span><span class="p">(</span><span class="s">&quot;d1&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span>
   <span class="n">TFile</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TFile</span><span class="p">(</span><span class="s">&quot;spectra</span><span class="se">\\</span><span class="s">TSpectrum.root&quot;</span><span class="p">);</span>
   <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">TH1F</span><span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;back3;1&quot;</span><span class="p">);</span>
   <span class="n">TCanvas</span> <span class="o">*</span><span class="n">background</span> <span class="o">=</span> <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">GetListOfCanvases</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">FindObject</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">background</span><span class="p">)</span> <span class="n">background</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCanvas</span><span class="p">(</span><span class="s">&quot;background&quot;</span><span class="p">,</span>
   <span class="s">&quot;Estimation of background with Compton edges under peaks&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">700</span><span class="p">);</span>
   <span class="n">h</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span>
   <span class="n">TSpectrum</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TSpectrum</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">h</span><span class="o">-&gt;</span><span class="n">GetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">s</span><span class="o">-&gt;</span><span class="n">Background</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">nbins</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">kBackDecreasingWindow</span><span class="p">,</span><span class="n">kBackOrder8</span><span class="p">,</span><span class="n">kTRUE</span><span class="p">,</span>
   <span class="n">kBackSmoothing5</span><span class="p">,,</span><span class="n">kTRUE</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbins</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetBinContent</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">SetLineColor</span><span class="p">(</span><span class="n">kRed</span><span class="p">);</span>
   <span class="n">d1</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">(</span><span class="s">&quot;SAME L&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<!-- TSpectrum.md ends here --></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="TSpectrum2.html" class="btn btn-neutral float-right" title="TSpectrum2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="TSelectorScalar.html" class="btn btn-neutral float-left" title="TSelectorScalar" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Hongyi Wu(吴鸿毅)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>